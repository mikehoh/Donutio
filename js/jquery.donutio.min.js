/* Donutio 2.5.2 by Michael Hohlovich */
!function(t){var e=function(e){return this.each(function(){var r=t.extend({multiple:!0,color_negative:"#f00",color_positive:"#0f0",color_zero:"#ddd",radius:200,width:10,padding:10,type:"donut",active:0,percents:!1,colored_percents:!1},e),n=2*(r.radius+r.padding),s=r.data.length;if(0!=s){var l=o(r.data),f=u(r.data,l),d=c(f[0],s),p=d[0],h=d[1];if(r.multiple)for(i=0;i<s;i++)a(n,p,r,h,i,t(this),l,f[2][i]);else a(n,p,r,h,r.active,t(this),l,f[2][r.active])}})},r=function(){return this.each(function(){var e=t(this).find(".donut");e.each(function(e,r){t(r).off()}),t(this).empty()})},n={init:e,destroy:r};t.fn.donutio=function(e){return n[e]?n[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.Donutio"):n.init.apply(this,arguments)};var a=function(e,r,n,i,a,o,u,c){var d=s(e),h=l("svg");h.setAttribute("width",e),h.setAttribute("height",e);var v=0,g=0;for(j=0;j<n.data.length;j++){v=g+r,g=v+i[j];var b=p(n,a);if(0==v&&360==g){var y=l("circle");y.setAttribute("cx",e/2),y.setAttribute("cy",e/2),y.setAttribute("r",n.radius)}else{var y=l("path");y.setAttribute("d",f(n.type,Math.floor(e/2),Math.floor(e/2),n.radius,v,g))}"donut"==n.type?(y.setAttribute("stroke-width",n.width),y.setAttribute("fill","none"),j==a?y.setAttribute("stroke",b.active):y.setAttribute("stroke",b.muted)):(y.setAttribute("stroke-width",0),j==a?y.setAttribute("fill",b.active):y.setAttribute("fill",b.muted)),h.appendChild(y)}if(d.append(h),n.percents){var w=t("<span class='value-percent' />").html(c.toString()+"%");n.colored_percents&&w.css("color",b.active),d.append(w)}if("text"in n.data[a]&&n.data[a].text.forEach(function(e,r){w=t("<span class='value-"+r+"' />").html(e),d.append(w)}),"url"in n.data[a]){var m=n.data[a].url,A=t("<a href='"+m+"' />").html(d);o.append(A)}else if(o.append(d),t.isFunction(n.onclick)){var x=n.onclick;d.on("click",function(t){t.preventDefault(),x(n.data[a].id)})}},o=function(t){var e=0;return t.forEach(function(t,r){e+=Math.abs(t.value)}),e},u=function(t,e){var r=[],n=[],i=[];return t.forEach(function(t,a){var o=Math.round(Math.abs(t.value)/e*1e4)/100,u=o;o>.005&&1>=o&&(u=1);var c=Math.ceil(3.6*u);r.push(c),n.push(u),i.push(o)}),[r,n,i]},c=function(t,e){var r=360-t.reduce(function(t,e){return t+e}),n=r/e;if(1>n||n>1.5){var i=n-1.5;t=t.map(function(t){return t+i}),n=1.5}return 1==t.length&&(t=[360],n=0),[n,t]},s=function(e){return t("<div class='donut' />").css({width:e})},l=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg",t);return"svg"==t&&e.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),e},f=function(t,e,r,n,i,a){var o=d(e,r,n,a),u=d(e,r,n,i),c=180>=a-i?"0":"1",s=[];return s="donut"==t?["M",o.x,o.y,"A",n,n,0,c,0,u.x,u.y].join(" "):["M",o.x,o.y,"A",n,n,0,c,0,u.x,u.y,"L",e,r,"L",o.x,o.y].join(" ")},d=function(t,e,r,n){var i=(n-90)*Math.PI/180;return{x:t+r*Math.cos(i),y:e+r*Math.sin(i)}},p=function(t,e){var r=t.data[e].value;return r>.005?{active:t.color_positive,muted:h(.8,t.color_positive,"#fff")}:-.005>r?{active:t.color_negative,muted:h(.8,t.color_negative,"#fff")}:{active:t.color_zero,muted:t.color_zero}},h=function(t,e,r){if("number"!=typeof t||-1>t||t>1||"string"!=typeof e||"r"!=e[0]&&"#"!=e[0]||"string"!=typeof r&&"undefined"!=typeof r)return null;this.sbcRip||(this.sbcRip=function(t){var e=t.length,r=new Object;if(e>9){if(t=t.split(","),t.length<3||t.length>4)return null;r[0]=n(t[0].slice(4)),r[1]=n(t[1]),r[2]=n(t[2]),r[3]=t[3]?parseFloat(t[3]):-1}else{switch(e){case 8:case 6:case 3:case 2:case 1:return null}6>e&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+(e>4?t[4]+""+t[4]:"")),t=n(t.slice(1),16),r[0]=t>>16&255,r[1]=t>>8&255,r[2]=255&t,r[3]=9==e||5==e?i((t>>24&255)/255*1e4)/1e4:-1}return r});var n=parseInt,i=Math.round,a=e.length>9,a="string"==typeof r?r.length>9?!0:"c"==r?!a:!1:a,o=0>t,t=o?-1*t:t,r=r&&"c"!=r?r:o?"#000000":"#FFFFFF",u=sbcRip(e),c=sbcRip(r);return u&&c?a?"rgb("+i((c[0]-u[0])*t+u[0])+","+i((c[1]-u[1])*t+u[1])+","+i((c[2]-u[2])*t+u[2])+(u[3]<0&&c[3]<0?")":","+(u[3]>-1&&c[3]>-1?i(1e4*((c[3]-u[3])*t+u[3]))/1e4:c[3]<0?u[3]:c[3])+")"):"#"+(4294967296+16777216*(u[3]>-1&&c[3]>-1?i(255*((c[3]-u[3])*t+u[3])):c[3]>-1?i(255*c[3]):u[3]>-1?i(255*u[3]):255)+65536*i((c[0]-u[0])*t+u[0])+256*i((c[1]-u[1])*t+u[1])+i((c[2]-u[2])*t+u[2])).toString(16).slice(u[3]>-1||c[3]>-1?1:3):null}}(jQuery);
